{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///c:/rmcontents1/app/login/page.tsx"],"sourcesContent":["// app/login/page.tsx\r\n\r\n\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { GoogleAuthProvider, signInWithPopup } from \"firebase/auth\";\r\nimport { auth } from \"@/lib/firebase\";\r\nimport { useAuth } from \"@/context/AuthContext\"; // AuthContext 훅 사용\r\nimport Image from \"next/image\";\r\n\r\nexport default function LoginPage() {\r\n  const { user, loading, isFirstLogin } = useAuth(); // 전역 상태 가져오기\r\n  const router = useRouter();\r\n\r\n  // [핵심 로직] 로그인 상태가 변경될 때마다 실행\r\n  useEffect(() => {\r\n    if (loading) return; // 로딩 중에는 대기\r\n\r\n    if (user) {\r\n      if (isFirstLogin === true) {\r\n        // 첫 로그인이면 프로필 설정으로\r\n        router.push(\"/profile/setup\");\r\n      } else if (isFirstLogin === false) {\r\n        // 기존 회원이면 대시보드로\r\n        router.push(\"/dashboard\");\r\n      }\r\n      // isFirstLogin이 null이면 (아직 체크 중) 대기\r\n    }\r\n    // user가 null이면 (로그아웃 상태) 로그인 페이지에 머무름\r\n  }, [user, loading, isFirstLogin, router]);\r\n\r\n  const handleGoogleLogin = async () => {\r\n    const provider = new GoogleAuthProvider();\r\n    try {\r\n      // signInWithPopup만 호출하면, AuthContext의 onIdTokenChanged 리스너가\r\n      // 자동으로 나머지를 (관리자 권한, 첫 로그인 체크) 처리합니다.\r\n      await signInWithPopup(auth, provider);\r\n    } catch (error) {\r\n      console.error(\"로그인 중 에러 발생:\", error);\r\n    }\r\n  };\r\n\r\n  // 이미 로그인을 시도 중이거나 로딩 중일 때 보여줄 화면\r\n  if (loading || user) {\r\n    return (\r\n      <div className=\"flex min-h-screen items-center justify-center\">\r\n        로그인 정보 확인 중...\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // 로그아웃 상태일 때만 로그인 버튼 표시\r\n  return (\r\n    <div className=\"flex min-h-screen flex-col items-center justify-center bg-gray-50\">\r\n      <div className=\"w-full max-w-md rounded-lg bg-white p-8 shadow-md\">\r\n        <div className=\"mb-8 text-center\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">RuleMakers</h1>\r\n          <p className=\"mt-2 text-gray-600\">강사님을 위한 컨텐츠 요청 시스템</p>\r\n        </div>\r\n        <button\r\n          onClick={handleGoogleLogin}\r\n          className=\"flex w-full items-center justify-center gap-3 rounded-lg border border-gray-300 bg-white px-4 py-3 font-medium text-gray-700 shadow-sm transition-colors hover:bg-gray-100\"\r\n        >\r\n          <Image src=\"/google-logo.svg\" alt=\"Google\" width={20} height={20} />\r\n          <span>Google 계정으로 로그인</span>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,qBAAqB;;;;;;AAIrB;AACA;AACA;AAAA;AACA;AACA,yNAAiD,mBAAmB;AACpE;;;AAPA;;;;;;;AASe,SAAS;;IACtB,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,YAAY,EAAE,GAAG,IAAA,qIAAO,KAAI,aAAa;IAChE,MAAM,SAAS,IAAA,kJAAS;IAExB,6BAA6B;IAC7B,IAAA,0KAAS;+BAAC;YACR,IAAI,SAAS,QAAQ,YAAY;YAEjC,IAAI,MAAM;gBACR,IAAI,iBAAiB,MAAM;oBACzB,mBAAmB;oBACnB,OAAO,IAAI,CAAC;gBACd,OAAO,IAAI,iBAAiB,OAAO;oBACjC,gBAAgB;oBAChB,OAAO,IAAI,CAAC;gBACd;YACA,oCAAoC;YACtC;QACA,sCAAsC;QACxC;8BAAG;QAAC;QAAM;QAAS;QAAc;KAAO;IAExC,MAAM,oBAAoB;QACxB,MAAM,WAAW,IAAI,mLAAkB;QACvC,IAAI;YACF,4DAA4D;YAC5D,sCAAsC;YACtC,MAAM,IAAA,gLAAe,EAAC,0HAAI,EAAE;QAC9B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,gBAAgB;QAChC;IACF;IAEA,iCAAiC;IACjC,IAAI,WAAW,MAAM;QACnB,qBACE,6LAAC;YAAI,WAAU;sBAAgD;;;;;;IAInE;IAEA,wBAAwB;IACxB,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAmC;;;;;;sCACjD,6LAAC;4BAAE,WAAU;sCAAqB;;;;;;;;;;;;8BAEpC,6LAAC;oBACC,SAAS;oBACT,WAAU;;sCAEV,6LAAC,2IAAK;4BAAC,KAAI;4BAAmB,KAAI;4BAAS,OAAO;4BAAI,QAAQ;;;;;;sCAC9D,6LAAC;sCAAK;;;;;;;;;;;;;;;;;;;;;;;AAKhB;GA3DwB;;QACkB,qIAAO;QAChC,kJAAS;;;KAFF","debugId":null}}]
}