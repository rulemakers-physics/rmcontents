{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///c:/rmcontents1/app/dashboard/page.tsx"],"sourcesContent":["// app/dashboard/page.tsx\r\n\r\n\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { useAuth } from \"@/context/AuthContext\";\r\nimport { db } from \"@/lib/firebase\";\r\nimport {\r\n  collection,\r\n  query,\r\n  where,\r\n  getDocs,\r\n  Timestamp,\r\n  orderBy,\r\n} from \"firebase/firestore\";\r\n\r\n// 강사 대시보드에서 사용할 요청 데이터 타입\r\ninterface MyRequestData {\r\n  id: string;\r\n  title: string;\r\n  status: \"requested\" | \"in_progress\" | \"completed\";\r\n  requestedAt: Timestamp;\r\n  completedAt?: Timestamp; // 완료된 작업에만 존재\r\n  completedFileUrl?: string; // 완료된 작업에만 존재\r\n}\r\n\r\nexport default function DashboardPage() {\r\n  const { user, loading } = useAuth();\r\n  const router = useRouter();\r\n  \r\n  const [requests, setRequests] = useState<MyRequestData[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  // 1. 로그인한 사용자의 요청 목록만 불러오기\r\n  useEffect(() => {\r\n    // AuthContext가 유저 정보를 로드할 때까지 대기\r\n    if (loading) return;\r\n    \r\n    // 로그아웃 상태면 로그인 페이지로\r\n    if (!user) {\r\n      router.push(\"/login\");\r\n      return;\r\n    }\r\n\r\n    const fetchMyRequests = async () => {\r\n      setIsLoading(true);\r\n      try {\r\n        // 'requests' 컬렉션에서 'instructorId'가 현재 유저의 uid와 같은 것만 쿼리\r\n        const q = query(\r\n          collection(db, \"requests\"),\r\n          where(\"instructorId\", \"==\", user.uid),\r\n          orderBy(\"requestedAt\", \"desc\") // 최신순으로 정렬\r\n        );\r\n        \r\n        const querySnapshot = await getDocs(q);\r\n        const requestList = querySnapshot.docs.map((doc) => ({\r\n          id: doc.id,\r\n          ...doc.data(),\r\n        } as MyRequestData));\r\n        \r\n        setRequests(requestList);\r\n      } catch (error) {\r\n        console.error(\"내 요청 목록을 불러오는 중 에러:\", error);\r\n      }\r\n      setIsLoading(false);\r\n    };\r\n\r\n    fetchMyRequests();\r\n  }, [user, loading, router]);\r\n\r\n  // 로딩 화면\r\n  if (loading || isLoading) {\r\n    return (\r\n      <div className=\"flex min-h-screen items-center justify-center\">\r\n        요청 목록을 불러오는 중...\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  // 로그인 안 된 상태 (위 useEffect에서 리디렉션되지만, 방어 코드)\r\n  if (!user) {\r\n    return null; \r\n  }\r\n\r\n  // --- 강사 대시보드 UI ---\r\n  return (\r\n    <div className=\"flex min-h-screen flex-col\">\r\n      <main className=\"flex-grow bg-gray-50 py-12\">\r\n        <div className=\"container mx-auto max-w-5xl px-6\">\r\n          \r\n          <div className=\"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center\">\r\n            <h1 className=\"text-3xl font-bold text-gray-900\">\r\n              요청한 작업 목록\r\n            </h1>\r\n            <Link \r\n              href=\"/request\"\r\n              className=\"rounded-md bg-blue-600 px-5 py-2.5 text-sm font-medium text-white shadow-sm transition-colors hover:bg-blue-700\"\r\n            >\r\n              + 새 작업 요청하기\r\n            </Link>\r\n          </div>\r\n          \r\n          <div className=\"mt-8 overflow-x-auto rounded-lg bg-white shadow\">\r\n            <table className=\"min-w-full divide-y divide-gray-200\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500\">상태</th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500\">요청 제목</th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500\">요청일</th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500\">완료/다운로드</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"divide-y divide-gray-200\">\r\n                {requests.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan={4} className=\"px-6 py-12 text-center text-gray-500\">\r\n                      아직 요청한 작업이 없습니다.\r\n                    </td>\r\n                  </tr>\r\n                ) : (\r\n                  requests.map((req) => (\r\n                    <tr key={req.id} className=\"hover:bg-gray-50\">\r\n                      {/* 상태 */}\r\n                      <td className=\"px-6 py-4\">\r\n                        {req.status === 'requested' && <span className=\"rounded-full bg-red-100 px-2 py-1 text-xs font-semibold text-red-700\">요청됨</span>}\r\n                        {req.status === 'in_progress' && <span className=\"rounded-full bg-yellow-100 px-2 py-1 text-xs font-semibold text-yellow-700\">작업중</span>}\r\n                        {req.status === 'completed' && <span className=\"rounded-full bg-green-100 px-2 py-1 text-xs font-semibold text-green-700\">완료됨</span>}\r\n                      </td>\r\n                      {/* 제목 */}\r\n                      <td className=\"px-6 py-4 font-medium text-gray-900\">{req.title}</td>\r\n                      {/* 요청일 */}\r\n                      <td className=\"px-6 py-4 text-gray-500\">{req.requestedAt.toDate().toLocaleDateString('ko-KR')}</td>\r\n                      {/* 완료/다운로드 */}\r\n                      <td className=\"px-6 py-4\">\r\n                        {req.status === 'completed' && req.completedFileUrl ? (\r\n                          <a\r\n                            href={req.completedFileUrl}\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"rounded-md bg-blue-100 px-3 py-2 text-sm font-medium text-blue-700 hover:bg-blue-200\"\r\n                          >\r\n                            다운로드\r\n                          </a>\r\n                        ) : (\r\n                          <span className=\"text-sm text-gray-400\">\r\n                            {req.status === 'in_progress' ? '작업 진행 중' : '대기 중'}\r\n                          </span>\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}