module.exports=[66680,(a,b,c)=>{b.exports=a.x("node:crypto",()=>require("node:crypto"))},49666,a=>{"use strict";var b=a.i(66680);let c={randomUUID:b.randomUUID},d=new Uint8Array(256),e=d.length,f=[];for(let a=0;a<256;++a)f.push((a+256).toString(16).slice(1));a.s(["v4",0,function(a,g,h){if(c.randomUUID&&!g&&!a)return c.randomUUID();var i=a,j=h;let k=(i=i||{}).random??i.rng?.()??(e>d.length-16&&((0,b.randomFillSync)(d),e=0),d.slice(e,e+=16));if(k.length<16)throw Error("Random bytes length must be >= 16");if(k[6]=15&k[6]|64,k[8]=63&k[8]|128,g){if((j=j||0)<0||j+16>g.length)throw RangeError(`UUID byte range ${j}:${j+15} is out of buffer bounds`);for(let a=0;a<16;++a)g[j+a]=k[a];return g}return function(a,b=0){return(f[a[b+0]]+f[a[b+1]]+f[a[b+2]]+f[a[b+3]]+"-"+f[a[b+4]]+f[a[b+5]]+"-"+f[a[b+6]]+f[a[b+7]]+"-"+f[a[b+8]]+f[a[b+9]]+"-"+f[a[b+10]]+f[a[b+11]]+f[a[b+12]]+f[a[b+13]]+f[a[b+14]]+f[a[b+15]]).toLowerCase()}(k)}],49666)},58286,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(53131),g=a.i(18740);a.i(69387);var h=a.i(60574);a.i(60121);var i=a.i(5420),j=a.i(49666);function k(){let{user:a,loading:k}=(0,f.useAuth)(),l=a?.isAdmin,m=(0,d.useRouter)(),n=(0,d.useParams)().requestId,[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(null);(0,c.useEffect)(()=>{n&&!k&&l&&(async()=>{r(!0);try{let a=(0,h.doc)(g.db,"requests",n),b=await (0,h.getDoc)(a);b.exists()?p({id:b.id,...b.data()}):t("해당 요청을 찾을 수 없습니다.")}catch(a){t("데이터를 불러오는 중 오류가 발생했습니다.")}r(!1)})()},[n,a,k,l]),(0,c.useEffect)(()=>{!k&&(a&&l||m.push("/dashboard"))},[a,k,l,m]);let A=async()=>{v(!0);try{let a=(0,h.doc)(g.db,"requests",n);await (0,h.updateDoc)(a,{status:"in_progress"}),p(a=>a?{...a,status:"in_progress"}:null)}catch(a){t("상태 변경 중 오류 발생")}v(!1)},B=async()=>{if(!y)return void t("완료 파일을 선택해주세요.");x(!0),t("");try{let a=`${(0,j.v4)()}-${y.name}`,b=`completed/${n}/${a}`,c=(0,i.ref)(g.storage,b);await (0,i.uploadBytes)(c,y);let d=await (0,i.getDownloadURL)(c),e=(0,h.doc)(g.db,"requests",n);await (0,h.updateDoc)(e,{status:"completed",completedAt:(0,h.serverTimestamp)(),completedFileUrl:d,completedStoragePath:b}),alert("작업 완료 처리 및 파일 업로드에 성공했습니다."),m.push("/admin")}catch(a){console.error("완료 처리 중 에러:",a),t("업로드 중 오류가 발생했습니다."),x(!1)}};return q||k||!l?(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:"로딩 중..."}):s?(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center text-red-500",children:s}):o?(0,b.jsx)("div",{className:"flex min-h-screen flex-col",children:(0,b.jsx)("main",{className:"flex-grow bg-gray-50 py-12",children:(0,b.jsxs)("div",{className:"container mx-auto max-w-3xl px-6",children:[(0,b.jsx)(e.default,{href:"/admin",className:"text-sm text-blue-600 hover:underline",children:"← 목록으로 돌아가기"}),(0,b.jsxs)("div",{className:"mt-4 rounded-lg bg-white p-8 shadow-md",children:[(0,b.jsxs)("div",{className:"border-b pb-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:o.title}),(0,b.jsx)("span",{className:`rounded-full px-3 py-1 text-sm font-semibold
                  ${"requested"===o.status?"bg-red-100 text-red-700":"in_progress"===o.status?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:o.status})]}),(0,b.jsxs)("p",{className:"mt-2 text-gray-600",children:[o.instructorName," (",o.academy,")"]}),(0,b.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["요청일: ",o.requestedAt.toDate().toLocaleString("ko-KR")]}),(0,b.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"상세 요청 내용"}),(0,b.jsx)("p",{className:"whitespace-pre-wrap rounded-md bg-gray-50 p-4 text-gray-700",children:o.details})]}),o.referenceFileUrl&&(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"첨부된 참고 파일"}),(0,b.jsx)("a",{href:o.referenceFileUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-2 inline-block text-blue-600 hover:underline",children:"참고 파일 다운로드"})]})]}),(0,b.jsxs)("div",{className:"mt-8",children:["requested"===o.status&&(0,b.jsxs)("div",{className:"rounded-md bg-yellow-50 p-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-yellow-800",children:"작업 시작"}),(0,b.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"이 요청의 작업을 시작하려면 작업 중으로 상태를 변경하세요."}),(0,b.jsx)("button",{onClick:A,disabled:u,className:"mt-3 rounded-md bg-yellow-500 px-4 py-2 text-sm font-medium text-white hover:bg-yellow-600 disabled:opacity-50",children:u?"변경 중...":"▷ 작업 중으로 변경"})]}),"completed"!==o.status&&(0,b.jsxs)("div",{className:"mt-8 rounded-md border border-gray-200 p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"작업 완료 및 파일 업로드"}),(0,b.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,b.jsx)("input",{type:"file",accept:".pdf",onChange:a=>{a.target.files&&a.target.files[0]&&z(a.target.files[0])},className:"block w-full text-sm text-gray-500   file:mr-4 file:rounded-md file:border-0   file:bg-blue-50 file:px-4 file:py-2   file:text-sm file:font-medium file:text-blue-700   hover:file:bg-blue-100"}),(0,b.jsx)("button",{onClick:B,disabled:w||!y,className:"w-full rounded-md bg-blue-600 px-6 py-3 text-base font-medium text-white hover:bg-blue-700 disabled:opacity-50",children:w?"업로드 중...":"✓ 완료 파일 제출하기"})]})]}),"completed"===o.status&&o.completedFileUrl&&(0,b.jsxs)("div",{className:"rounded-md bg-green-50 p-6 text-center",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-green-800",children:"작업 완료됨"}),(0,b.jsx)("p",{className:"mt-2 text-green-700",children:"이 작업은 완료되어 강사에게 전달되었습니다."}),(0,b.jsx)("a",{href:o.completedFileUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-4 inline-block text-blue-600 hover:underline",children:"업로드된 완료 파일 확인"})]}),s&&(0,b.jsx)("p",{className:"mt-4 text-center text-red-500",children:s})]})]})]})})}):(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:"요청 정보를 찾을 수 없습니다."})}a.s(["default",()=>k])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__442bfbc8._.js.map